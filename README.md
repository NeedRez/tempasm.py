# tempasm.py
Converts a template file into a "code generator" python script, then imports the generator to run the generated code.
# Purpose
Bringing the power of Python to Assembly language generation. Let Python "do the math" so you don't have to remember bits and bytes.
# Usage
Example script is shown here:
~~~~
.>import avr
.>from avr import ddr, port, pin, mask
.\avr.iodef
A[7:0]
[INITA]
AC_DET={T}
RELAY={H}
SCTL3={P}
SCTL2		;default
SCTL1={T}
RXIR={P}
L1_INA={H}
L2_INB={H}
./
.\
	;signal tags can now be inserted into code
	;{{mask.RELAY}} = {mask.RELAY}
	;{{pin.RELAY}} = {pin.RELAY}
	;{{port.RELAY}} = {port.RELAY}
	;{{ddr.RELAY}} = {ddr.RELAY}

	ldi	r24, 0b{port.INITA:08b}	; uses defined name INITA as preset {{port.INITA}}
	out	PORTA, r24
	ldi	r24, 0b{ddr.INITA:08b}	; {{ddr.INITA}}
	out	DDRA, r24
./
~~~~

This python script is generated:
~~~
#!/usr/bin/env python
#autogenerated from test.s
import sys
import avr
from avr import ddr, port, pin, mask
avr.iodef(r"""A[7:0]
[INITA]
AC_DET={T}
RELAY={H}
SCTL3={P}
SCTL2		;default
SCTL1={T}
RXIR={P}
L1_INA={H}
L2_INB={H}
""")
if 1:
    sys.stdout.write(r"""	;signal tags can now be inserted into code
	;{{mask.RELAY}} = {mask.RELAY}
	;{{pin.RELAY}} = {pin.RELAY}
	;{{port.RELAY}} = {port.RELAY}
	;{{ddr.RELAY}} = {ddr.RELAY}

	ldi	r24, 0b{port.INITA:08b}	; uses defined name INITA as preset {{port.INITA}}
	out	PORTA, r24
	ldi	r24, 0b{ddr.INITA:08b}	; {{ddr.INITA}}
	out	DDRA, r24
""".format(**locals()))
~~~

The output is here:
~~~
.def	AC_DET	PA7	; (ddr,port)=(0,0)
.def	RELAY	PA6	; (ddr,port)=(1,1)
.def	SCTL3	PA5	; (ddr,port)=(0,1)
.def	SCTL2	PA4	; (ddr,port)=(0,1)
.def	SCTL1	PA3	; (ddr,port)=(0,0)
.def	RXIR	PA2	; (ddr,port)=(0,1)
.def	L1_INA	PA1	; (ddr,port)=(1,1)
.def	L2_INB	PA0	; (ddr,port)=(1,1)
	;signal tags can now be inserted into code
	;{mask.RELAY} = PA6
	;{pin.RELAY} = PINA
	;{port.RELAY} = PORTA
	;{ddr.RELAY} = DDRA

	ldi	r24, 0b01110111	; uses defined name INITA as preset {port.INITA}
	out	PORTA, r24
	ldi	r24, 0b01000011	; {ddr.INITA}
	out	DDRA, r24
~~~
